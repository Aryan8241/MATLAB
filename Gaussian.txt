clc;
clear;
close all;

%% Parameters
Fs = 1000;            % Sampling frequency (Hz)
t = 0:1/Fs:1;         % Time vector (1 second duration)
f = 50;               % Signal frequency (Hz)

%% Original Signal
x = sin(2*pi*f*t);    % Clean sine wave

%% Add Gaussian Noise
noise = 0.5 * randn(size(t));  % Gaussian noise
xn = x + noise;                % Noisy signal

%% SNR Before Filtering
snr_before = snr(x, noise);

%% Low-Pass Filter Design (Butterworth)
cutoff = 100;                   % Cutoff frequency (Hz)
order = 4;                      % Filter order
Wn = cutoff / (Fs/2);           % Normalized cutoff
[b, a] = butter(order, Wn, 'low');

%% Filter the Noisy Signal
xf = filtfilt(b, a, xn);        % Zero-phase filtering

%% SNR After Filtering
noise_after = xf - x;
snr_after = snr(x, noise_after);

%% Plot Signals
figure;

subplot(4,1,1)
plot(t, x)
title('Original Signal')
xlabel('Time (s)')
ylabel('Amplitude')
grid on

subplot(4,1,2)
plot(t, xn)
title('Noisy Signal (Gaussian Noise Added)')
xlabel('Time (s)')
ylabel('Amplitude')
grid on

subplot(4,1,3)
plot(t, xf)
title('Filtered Signal (Low-Pass Filter)')
xlabel('Time (s)')
ylabel('Amplitude')
grid on

subplot(4,1,4)
plot(t, noise)
title('Gaussian Noise')
xlabel('Time (s)')
ylabel('Amplitude')
grid on

%% Display SNR Results
fprintf('SNR Before Filtering : %.2f dB\n', snr_before);
fprintf('SNR After Filtering  : %.2f dB\n', snr_after);
